{"pageProps":{"mdMeta":{"realpath":"/home/runner/work/jokester.github.io/jokester.github.io/posts/2019/2019-09-07-install-docker-wo-aufs-debian.md","slug":["2019-09-07","install-docker-wo-aufs-debian"],"frontMatter":{"title":"Install docker-ce without aufs in Debian","publishAt":"2019-09-07"}},"mdContent":"\nThe offical build of [docker-ce for debian](https://docs.docker.com/install/linux/docker-ce/debian/)\nlisted [dkms](https://en.wikipedia.org/wiki/Dynamic_Kernel_Module_Support)\nand dkms-built [aufs](https://en.wikipedia.org/wiki/Aufs)\nas (non-optional) dependencies. This causes `aufs` kernel module to be built on every kernel update.\n\nAlso the `aufs` module (for docker's `aufs` storage driver) may not even get used:\nrecent docker would pick newer `overlay2` (available since Linux 4.0) or `btrfs` storage driver when possible.\n\nThis article introduces how to make sure `aufs` is not used, and how to install `docker-ce` without it.\n\nIf you dont have docker-ce installed (and believe aufs won't be required), just skip to the last part.\n\n## Make sure aufs is not used\n\n```shell\n$ sudo docker info\n\nServer:\n Containers: 4\n  Running: 4\n  Paused: 0\n  Stopped: 0\n Images: 11\n Server Version: 19.03.2-ce\n Storage Driver: btrfs      << clean if this is not 'aufs'\n```\n\n```sh\n$ modprobe | grep aufs\n                            << clean if nothing appears (the module doesn't exist) or 'aufs 0' (not used)\n```\n\n## (re-) Install docker-ce without aufs\n\nNOTE: if docker is already installed with default dependencies, there is no need to remove it first (in that case apt just remove unnecessary direct dependent packages. Remember to `apt autoremove` to remove transitive dependencies after that).\n\n```shell\n$ sudo apt install docker-ce aufs-dkms- aufs-tools-\n```\n"},"__N_SSG":true}