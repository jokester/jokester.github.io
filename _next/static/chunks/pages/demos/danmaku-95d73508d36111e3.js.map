{"version":3,"file":"static/chunks/pages/demos/danmaku-95d73508d36111e3.js","mappings":"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","sources":["webpack://_N_E/?88de","webpack://_N_E/./src/components/fps-meter.tsx","webpack://_N_E/./src/components/demo-waapi/demo-waapi-danmaku.tsx","webpack://_N_E/./src/components/demo-waapi/danmaku-resource.ts","webpack://_N_E/./pages/demos/danmaku.tsx","webpack://_N_E/./src/components/layout/header.tsx","webpack://_N_E/./src/config/build-env.ts","webpack://_N_E/./src/components/external/tracking-tags.tsx","webpack://_N_E/./src/components/layout/layout.tsx","webpack://_N_E/./src/components/meta/html-meta.tsx","webpack://_N_E/./src/config/const.ts","webpack://_N_E/./src/config/routes.ts","webpack://_N_E/./src/utils/debug-logger.ts","webpack://_N_E/<anon>"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/demos/danmaku\",\n      function () {\n        return require(\"private-next-pages/demos/danmaku.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/demos/danmaku\"])\n      });\n    }\n  ","import { FC, useState } from 'react';\nimport { animationFrameScheduler, interval, Observable, range } from 'rxjs';\nimport { map, scan, tap, throttleTime } from 'rxjs/operators';\nimport useConstant from 'use-constant';\nimport { useObservable } from 'react-use';\n\nconst everyFrame = range(0, Number.MAX_SAFE_INTEGER, animationFrameScheduler);\n\nfunction fpsObservable(numFrame: number): Observable<number> {\n  return everyFrame.pipe(\n    map((frameNo) => Date.now() / 1e3),\n    scan((acc, l) => [...acc, l].slice(-numFrame), [] as number[]),\n    map((frames) => (frames.length >= numFrame ? numFrame / (frames[frames.length - 1] - frames[0]) : -1)),\n    throttleTime(0.5e3),\n  );\n}\n\nexport const FpsMeter: FC = () => {\n  return (\n    <div className=\"fixed right-0 bottom-0 p-4 border-black border inline-block w-64\">\n      <FpsMeterRow samples={15} />\n      <FpsMeterRow samples={60} />\n    </div>\n  );\n};\n\nconst FpsMeterRow: FC<{ samples: number }> = ({ samples }) => {\n  const fps$ = useConstant(() => fpsObservable(samples));\n  const fps = useObservable(fps$, 0);\n\n  return (\n    <p>\n      fps ({samples}frames): {fps.toFixed(3)}\n    </p>\n  );\n};\n","import { Observable } from 'rxjs';\nimport { useEffect, useRef } from 'react';\nimport { randomRange } from 'fp-ts/Random';\nimport { pipe } from 'fp-ts/function';\nimport { io } from 'fp-ts';\nimport classNames from 'classnames';\n\nexport const WaapiDanmaku: React.FC<{ source$: Observable<string> }> = (props) => {\n  const divRef = useRef<HTMLDivElement>(null!);\n\n  useEffect(() => {\n    const div = divRef.current;\n\n    const cameraDistance = 100;\n    const sourceDistance = 110;\n\n    const perspectiveHalfAngleH = Math.atan(div.clientWidth / 2 / sourceDistance);\n    const perspectiveHalfAngleV = Math.atan(div.clientHeight / 2 / sourceDistance);\n    const finalZ = 500;\n\n    const randomness = {\n      tx: pipe(\n        randomRange(-div.clientWidth / 2, div.clientWidth / 2),\n        // io.map((x) => `translateX(${x}px)`),\n      ),\n      ty: pipe(\n        randomRange(-div.clientHeight / 2, div.clientHeight / 2),\n        // io.map((y) => `translateY(${y}px)`),\n      ),\n    } as const;\n\n    const s = props.source$.subscribe((content) => {\n      const p = document.createElement('p');\n      p.className = classNames('absolute');\n      p.textContent = content;\n\n      const tx = randomness.tx(),\n        ty = randomness.ty(),\n        rotateX = Math.atan(ty / cameraDistance),\n        rotateY = Math.atan(tx / cameraDistance);\n\n      div.appendChild(p);\n      const a = p.animate(\n        [\n          {\n            transform: [`translateZ(110px)`].join(' '),\n            // filter: 'blur(0px)',\n            offset: 0,\n          },\n          {\n            transform: [\n              //\n              `translateX(${tx}px)`,\n              `translateY(${ty}px)`,\n\n              `translateZ(0px)`,\n            ].join(' '),\n            // filter: 'blur(0px)',\n            offset: 0.382,\n          },\n          {\n            transform: [\n              `translateX(${(tx / cameraDistance) * (cameraDistance + 1000)}px)`,\n              `translateY(${(ty / cameraDistance) * (cameraDistance + 1000)}px)`,\n              // `rotateX(${rotateX}rad)`,\n              // `rotateY(${rotateY}rad)`,\n              `translateZ(-1000px)`,\n              // `rotateX(${-rotateX}rad)`,\n              // `rotateY(${-rotateY}rad)`,\n            ].join(' '),\n            offset: 0.9,\n          },\n          {\n            transform: [\n              `translateX(${(tx / cameraDistance) * (cameraDistance + finalZ)}px)`,\n              `translateY(${(ty / cameraDistance) * (cameraDistance + finalZ)}px)`,\n              // `rotateX(${rotateX}rad)`,\n              // `rotateY(${rotateY}rad)`,\n              `translateZ(${-finalZ}px)`,\n              // `rotateX(${-rotateX}rad)`,\n              // `rotateY(${-rotateY}rad)`,\n            ].join(' '),\n            // filter: `opacity(0) blur(1px)`, // NOTE: add filter to keyframes breaks font rendering?\n            offset: 1,\n          },\n        ],\n        {\n          duration: 10e3,\n          composite: 'add',\n          easing: 'linear',\n          iterationComposite: 'replace',\n        },\n      );\n\n      a.finished\n        .then(() => {\n          p.style.transform = [\n            `translateX(${(tx / cameraDistance) * (cameraDistance + finalZ)}px)`,\n            `translateY(${(ty / cameraDistance) * (cameraDistance + finalZ)}px)`,\n            // `rotateX(${rotateX}rad)`,\n            // `rotateY(${rotateY}rad)`,\n            `translateZ(${-finalZ}px)`,\n            // `rotateX(${-rotateX}rad)`,\n            // `rotateY(${-rotateY}rad)`,\n          ].join(' ');\n          return p.animate(\n            { filter: ['', 'opacity(0) blur(1000px)'] },\n            {\n              duration: 1e3,\n              composite: 'accumulate',\n            },\n          ).finished;\n        })\n        .then(() => p.remove());\n    });\n\n    return () => s.unsubscribe();\n  }, [props.source$]);\n\n  return (\n    <div className=\"bg-white\">\n      <div\n        ref={divRef}\n        style={{ height: '50vh', perspective: '100px' }}\n        className={classNames('text-black flex justify-center items-center overflow-hidden')}\n      />\n    </div>\n  );\n};\n\nfunction randomSource(container: HTMLDivElement) {}\n","import { interval, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nconst terms = `\n反也者 道之動也 弱也者 道之用也 天下之物生於有 有生於无 爲學者日益 聞道者日損 損之又損 以至於无爲 无爲而无不爲\n將欲取天下者恆无事 及其有事也 不足以取天下 信言不美 美言不信 知者不博 博者不知 善者不多 多者不善 聖人无積 既以爲人己愈有 既以予人己愈多\n故天之道 利而不害 人之道 爲而弗爭 知不知 尚矣 不知不知 病矣 是以聖人之不病 以其病病也 是以不病 道 可道也 非恆道也 名 可名也 非恆名也\n無名 萬物之始也 有名 萬物之母也 故恆无欲也 以觀其眇 恆有欲也以觀其所噭 兩者同出 異名同謂 玄之有玄 眾眇之門 戴營抱一 能毋離乎 摶氣至柔 能嬰兒乎\n脩除玄藍 能毋疵乎 愛民栝國 能毋以知乎 天門啓闔 能爲雌乎 明白四達 能毋以知乎 生之 畜之 生而弗有 長而弗宰也 是謂玄德 知其雄 守其雌 爲天下谿\n爲天下谿 恆德不離 恆德不離 復歸嬰兒 知其榮 守其辱 爲天下浴 爲天下浴 恆德乃足 德乃足 復歸於樸 知其白 守其黑 爲天下式 爲天下式 恆德不忒 恆德不忒 復歸於无極\n樸散則爲器 聖人用則爲官長 夫大制无割\n`\n  .split(/\\s/)\n  .map((_) => _.trim())\n  .filter((_) => _);\n\nexport function createTermsObservable(_interval: number): Observable<string> {\n  return interval(_interval).pipe(map((count) => terms[count % terms.length]));\n}\n\ninterface DanmakuItem {\n  content: string;\n  start(container: HTMLElement, content: string): () => void;\n}\n","import { Layout } from '../../src/components/layout/layout';\nimport { HtmlMeta } from '../../src/components/meta/html-meta';\nimport React from 'react';\nimport { FpsMeter } from '../../src/components/fps-meter';\nimport { WaapiDanmaku } from '../../src/components/demo-waapi/demo-waapi-danmaku';\nimport useConstant from 'use-constant';\nimport { createTermsObservable } from '../../src/components/demo-waapi/danmaku-resource';\n\nconst DemoCss3dTransform = () => {\n  const x = useConstant(() => createTermsObservable(0.3e3));\n  return (\n    <Layout>\n      <HtmlMeta title=\"DEMO: css 3d transform\" />\n      <FpsMeter />\n      <div className=\"p-4 select-none \" style={{ height: 600 }}>\n        <WaapiDanmaku source$={x} />\n      </div>\n    </Layout>\n  );\n};\n\nexport default DemoCss3dTransform;\n","import React, { PropsWithChildren } from 'react';\nimport classNames from 'classnames';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { TypedRoutes } from '../../config/routes';\nimport { bcss, SiteMeta } from '../../config/const';\n\nconst linkClass = bcss({});\n\nconst SectionLink: React.FC<PropsWithChildren<{ path: string; className?: string }>> = (props) => {\n  const { pathname } = useRouter();\n  return (\n    <Link\n      href={props.path}\n      className={classNames(props.className ?? '', {\n        ['text-yellow-200']: props.path !== TypedRoutes.index && pathname.startsWith(props.path),\n      })}\n    >\n      {props.children}\n    </Link>\n  );\n};\n\nexport const Header: React.FC = () => {\n  return (\n    <div className=\"px-2 sm:px-4 py-1 flex items-center bg-gray-900 space-x-3 text-sm\">\n      <SectionLink className=\"hidden text-lg\" path={TypedRoutes.index}>\n        {SiteMeta.siteTitleShorter}\n      </SectionLink>\n      <SectionLink className=\"inline-block sm:hidden text sm:text-lg\" path={TypedRoutes.index}>\n        {SiteMeta.siteTitleShort}\n      </SectionLink>\n      <SectionLink className=\"hidden sm:inline-block text-lg\" path={TypedRoutes.index}>\n        {SiteMeta.siteTitle}\n      </SectionLink>\n      <span>|</span>\n      <SectionLink path={TypedRoutes.posts.index}>/posts</SectionLink>\n      <SectionLink path=\"/demos\">/demos</SectionLink>\n      <SectionLink path=\"/works\">/works</SectionLink>\n      <SectionLink path={TypedRoutes.about.me}>/about</SectionLink>\n    </div>\n  );\n};\n","declare const process: {\n  env: {\n    SOME_CONSTANT: string;\n    NEXT_DEV: boolean;\n    GA_TRACKING_ID: string;\n  };\n};\n\nexport const inBrowser = typeof window !== 'undefined';\nexport const inServer = !inBrowser;\n\nexport const isDevBuild = !!process.env.NEXT_DEV;\n\nexport const buildEnv = {\n  SOME_CONSTANT: process.env.SOME_CONSTANT,\n  GA_TRACKING_ID: process.env.GA_TRACKING_ID || null,\n} as const;\n\nexport type BuildEnv = typeof buildEnv;\n","import React, { useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { buildEnv } from '../../config/build-env';\nimport { createLogger } from '../../utils/debug-logger';\nimport Head from 'next/head';\n\nconst logger = createLogger(__filename);\n\ndeclare function gtag(...args: any[]): void;\n\n/**\n * taken from https://github.com/zeit/next.js/blob/canary/examples/with-google-analytics/pages/_document.js\n * @returns {any}\n * @constructor\n */\nexport const GoogleAnalyticsTag: React.FC = () => {\n  const { GA_TRACKING_ID } = buildEnv;\n  const router = useRouter();\n\n  useEffect(() => {\n    logger('GA_TRACKING_ID', GA_TRACKING_ID);\n    if (GA_TRACKING_ID) {\n      const url = router.asPath;\n      logger('RouteChangeComplete', url);\n      setTimeout(() => {\n        typeof gtag === 'function' &&\n          gtag('config', GA_TRACKING_ID, {\n            page_location: url,\n            page_title: document.title,\n          });\n      }, 0);\n    }\n  }, []);\n\n  return (\n    (GA_TRACKING_ID && (\n      <Head>\n        {/* Global Site Tag (gtag.js) - Google Analytics */}\n        <script async src={`https://www.googletagmanager.com/gtag/js?id=${GA_TRACKING_ID}`} />\n        <script\n          dangerouslySetInnerHTML={{\n            __html: `\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', '${GA_TRACKING_ID}', {\n              page_path: window.location.pathname,\n            });\n          `,\n          }}\n        />\n      </Head>\n    )) ||\n    null\n  );\n};\n","import React, { PropsWithChildren, useEffect } from 'react';\nimport { Header } from './header';\nimport { GoogleAnalyticsTag } from '../external/tracking-tags';\n\ninterface LayoutProps {}\n\nexport const Layout: React.FC<PropsWithChildren<LayoutProps>> = (props) => {\n  return (\n    <div className=\"bg-black text-yellow-100\">\n      <GoogleAnalyticsTag />\n      <Header />\n      <div className=\"min-h-screen container mx-auto\">\n        <div className=\"px-4 pt-6\">{props.children}</div>\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport { SiteMeta } from '../../config/const';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport { createLogger } from '../../utils/debug-logger';\n\nconst logger = createLogger(__filename);\nexport const HtmlMeta: React.FC<{ title: string }> = (props) => {\n  /**\n   * TODO: ogp / keywords / etc\n   */\n  const router = useRouter();\n\n  return (\n    <Head>\n      <title>{props.title}</title>\n      <meta httpEquiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,maximum-scale=1.5,minimum-scale=1\" />\n      <link rel=\"canonical\" href={`${SiteMeta.canonicalOrigin}${router.asPath}`} />\n    </Head>\n  );\n};\n","import { css, CSSObject } from '@emotion/react';\n\nexport const SiteMeta = {\n  canonicalOrigin: `https://jokester.github.io`,\n  siteTitle: `挖坑自動機 / Digging automaton`,\n  siteTitleShort: `挖坑自動機`,\n  siteTitleShorter: `挖`,\n  siteDesc: 'Posts and works about Web, Android, Linux and stuff.',\n} as const;\n\nconst breakpoints = [360, 640, 768, 1024, 1280];\n\nconst mq = breakpoints.map((bp) => `@media (min-width: ${bp}px)`);\n\nexport function bcss(_default: CSSObject, ...objects: Array<CSSObject>): CSSObject {\n  const built = { ..._default };\n  for (let i = 0; i < mq.length; i++) {\n    built[mq[i]] = objects[i];\n  }\n\n  return built;\n}\n","import { ParsedUrlQuery } from 'querystring';\n\n/**\n * @note MUST have trailing slash\n */\nexport const TypedRoutes = {\n  index: '/',\n  posts: {\n    index: '/posts/',\n    show: (pathSegments: string[]) => `/posts/${pathSegments.join('/')}/`,\n  },\n  works: '/works/',\n  about: {\n    me: '/about/',\n  },\n} as const;\nexport type TypedRouteParam<RouteNode> = RouteNode extends (param: infer Param) => string\n  ? Param & ParsedUrlQuery\n  : never;\n","import debug from 'debug';\nconst repoRoot = __filename.replace(/src[\\\\/]utils[\\\\/].*$/i, '');\n\nexport function createLogger(srcFile: string): debug.IDebugger {\n  const tag = srcFile\n    .slice(repoRoot.length)\n    .replace(/^src[\\\\/]/i, '')\n    .replace(/[\\\\/]/g, ':');\n  // console.log('createLogger: root', [__dirname, __filename, repoRoot]);\n  // console.log('createLogger: tag', [srcFile, tag]);\n\n  return debug(tag);\n}\n"],"names":["window","__NEXT_P","push","__webpack_require__","everyFrame","range","Number","MAX_SAFE_INTEGER","animationFrameScheduler","FpsMeter","jsx_runtime","jsxs","div","className","jsx","FpsMeterRow","samples","param","fps$","useConstant","pipe","map","frameNo","Date","now","scan","acc","l","_to_consumable_array","Z","slice","frames","length","numFrame","throttleTime","fps","useObservable","p","toFixed","WaapiDanmaku","props","divRef","useRef","useEffect","current","clientWidth","clientHeight","randomness","tx","randomRange","ty","s","source$","subscribe","content","document","createElement","classNames","textContent","appendChild","a","animate","transform","offset","concat","join","cameraDistance","duration","composite","easing","iterationComposite","finished","then","style","filter","remove","unsubscribe","ref","height","perspective","terms","split","_","trim","danmaku","x","interval","count","Layout","HtmlMeta","title","bcss","SectionLink","pathname","useRouter","Link","href","path","_define_property","TypedRoutes","startsWith","children","Header","SiteMeta","span","buildEnv","SOME_CONSTANT","process","env","GA_TRACKING_ID","logger","createLogger","GoogleAnalyticsTag","router","url","asPath","setTimeout","gtag","page_location","page_title","Head","script","async","src","dangerouslySetInnerHTML","__html","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","meta","httpEquiv","name","link","rel","canonicalOrigin","siteTitle","siteTitleShort","siteTitleShorter","siteDesc","mq","breakpoints","bp","_default","_len","arguments","objects","_key","built","_swc_helpers_src_object_spread_mjs__WEBPACK_IMPORTED_MODULE_0__","i","index","posts","show","pathSegments","works","about","me","repoRoot","__filename","replace","srcFile","tag","debug"],"sourceRoot":""}