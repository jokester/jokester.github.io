<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-39627402-1"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-39627402-1', {
              page_path: window.location.pathname,
            });
          </script><title>分享你的 TypeScript 类型声明</title><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.5,minimum-scale=1"/><link rel="canonical" href="https://jokester.github.io/posts/2017-04-14/share-your-typescript-types/"/><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/4aea23cc4ba74f25.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4aea23cc4ba74f25.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3278669249d12298.js" defer=""></script><script src="/_next/static/chunks/framework-e6d86b677864e3f5.js" defer=""></script><script src="/_next/static/chunks/main-bd374c4482f3a8c9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f13ade3d405e605a.js" defer=""></script><script src="/_next/static/chunks/782-c0d129453d73cf2f.js" defer=""></script><script src="/_next/static/chunks/503-60468e2aaeee9d33.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5B...slug%5D-0a158f9191a6a0a4.js" defer=""></script><script src="/_next/static/_QvQikHdy6XDN8mZszHK8/_buildManifest.js" defer=""></script><script src="/_next/static/_QvQikHdy6XDN8mZszHK8/_ssgManifest.js" defer=""></script></head><body class="overflow-y-scroll"><div id="__next"><div class="bg-black text-yellow-100"><div class="min-h-screen container mx-auto"><div class="px-4 py-1 flex items-center bg-gray-900 space-x-4 text-sm"><a class="sm:hidden text-lg" href="/">挖坑自動機</a><a class="hidden sm:inline-block text-lg" href="/">挖坑自動機 / Digging automaton</a><span>|</span><a class="text-yellow-200" href="/posts/">/posts</a><a class="" href="/works/">/works</a><a class="" href="/about/">/about</a></div><div class="px-4 pt-6"><div class="markdown"><h1></h1><hr/><div class="markdown"><p>最近给自己用的几个 js 库补上了 TypeScript 的类型声明，简单写几行。</p>
<h2>背景 1: 什么是类型声明</h2>
<p>在 TypeScript 中使用 JavaScript 代码时，需要有那个模块的类型声明。如果 <code>require / import</code>的模块没有类型声明，一般就会直接编译错误。</p>
<h2>背景 2: 怎样写类型声明</h2>
<p>可参考 <a href="https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html">TypeScript Handbook</a></p>
<h2>怎样发布 / 从哪找到类型声明</h2>
<p>类型声明一般有这两种发布方式:</p>
<ol>
<li>合并到本体 npm 包</li>
</ol>
<p>对于 TS 开发者来说，这是最方便的方式: 只要安装一个 npm 包就能直接使用相应版本的类型声明。TypeScript Handbook 也推荐这种方式为首选。我们要分享时也不妨先试试朝本体的 repo 发 PR，下面的 <code>合并到本体时的PR</code> 一节会介绍 PR 常有的内容。</p>
<p>感觉近年这种方式有增加的倾向，我自己常用的库中 <code>redux</code> / <code>Immutable.js</code> / <code>preact</code> 都已经自带了。</p>
<ol start="2">
<li>发到 <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/">DefinitelyTyped</a>。这里的类型声明会自动被发布在 npm 的 <code>@types/</code> 包，如 <code>@types/react</code>。</li>
</ol>
<h2>分享的好处</h2>
<ul>
<li>回馈给社区给更多人用，可能更快发现问题甚至有人帮着改，这会降低将来的维护成本</li>
<li>和开发者混个脸熟，问问题和求 feature 时比较好意思 (doge)</li>
<li>加声望和功德值</li>
</ul>
<h2>合并到本体时的 PR</h2>
<ul>
<li>类型声明文件本身</li>
<li>在<code>package.json</code>里加上类型声明的路径，如 <code>&quot;types&quot;: &quot;src/index.d.ts&quot;</code></li>
<li>有类型声明才能通过编译的 <code>TypeScript</code>代码 (这个测试不一定需要实际执行，如<a href="https://github.com/jokester/node-libtidy/blob/5806f74ed1d801b3ee6c860b7d05c6dd37c24376/test/ts-decl-test.ts#L32">ts-decl-test.ts</a></li>
<li>Readme / contributors 等</li>
<li>如果将来你也要继续用这份类型声明，不妨表明 &quot;需要改 bug/更新时可以找我&quot;。相信维护者会更愿意接受这样的 PR</li>
<li>如果你用代码生成类型声明: 生成用的代码，使用说明，以及生成时需要的包</li>
</ul></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"mdMeta":{"realpath":"/home/runner/work/jokester.github.io/jokester.github.io/posts/2017/2017-04-14-share-your-typescript-types.md","slug":["2017-04-14","share-your-typescript-types"],"frontMatter":{"title":"分享你的 TypeScript 类型声明","publishAt":"2017-04-14"}},"mdContent":"\n最近给自己用的几个 js 库补上了 TypeScript 的类型声明，简单写几行。\n\n## 背景 1: 什么是类型声明\n\n在 TypeScript 中使用 JavaScript 代码时，需要有那个模块的类型声明。如果 `require / import`的模块没有类型声明，一般就会直接编译错误。\n\n## 背景 2: 怎样写类型声明\n\n可参考 [TypeScript Handbook](https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html)\n\n## 怎样发布 / 从哪找到类型声明\n\n类型声明一般有这两种发布方式:\n\n1. 合并到本体 npm 包\n\n对于 TS 开发者来说，这是最方便的方式: 只要安装一个 npm 包就能直接使用相应版本的类型声明。TypeScript Handbook 也推荐这种方式为首选。我们要分享时也不妨先试试朝本体的 repo 发 PR，下面的 `合并到本体时的PR` 一节会介绍 PR 常有的内容。\n\n感觉近年这种方式有增加的倾向，我自己常用的库中 `redux` / `Immutable.js` / `preact` 都已经自带了。\n\n2. 发到 [DefinitelyTyped](https://github.com/DefinitelyTyped/DefinitelyTyped/)。这里的类型声明会自动被发布在 npm 的 `@types/` 包，如 `@types/react`。\n\n## 分享的好处\n\n- 回馈给社区给更多人用，可能更快发现问题甚至有人帮着改，这会降低将来的维护成本\n- 和开发者混个脸熟，问问题和求 feature 时比较好意思 (doge)\n- 加声望和功德值\n\n## 合并到本体时的 PR\n\n- 类型声明文件本身\n- 在`package.json`里加上类型声明的路径，如 `\"types\": \"src/index.d.ts\"`\n- 有类型声明才能通过编译的 `TypeScript`代码 (这个测试不一定需要实际执行，如[ts-decl-test.ts](https://github.com/jokester/node-libtidy/blob/5806f74ed1d801b3ee6c860b7d05c6dd37c24376/test/ts-decl-test.ts#L32)\n- Readme / contributors 等\n- 如果将来你也要继续用这份类型声明，不妨表明 \"需要改 bug/更新时可以找我\"。相信维护者会更愿意接受这样的 PR\n- 如果你用代码生成类型声明: 生成用的代码，使用说明，以及生成时需要的包\n"},"__N_SSG":true},"page":"/posts/[...slug]","query":{"slug":["2017-04-14","share-your-typescript-types"]},"buildId":"_QvQikHdy6XDN8mZszHK8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>